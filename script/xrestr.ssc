%SCRIPT XRESTR
%%
% VARIABLE CHARACTER CAT1 CAT2 CAT3 CLINE1 RSVAL RSESD CATM
% VARIABLE REAL 
%%
%%
% VERIFY DIST ANGLE PLANE
% GET NOSTORE SILENT FINAL ABBREVIATED 'Restraint type?' 'DIST'
% CASE VALUE
%   BLOCK %DIST%
%% Get two values and an END.
^^WI WINDOW XRESTRD 'Restrain Distance' MODAL
^^WI GRID RESMAIN NROWS=5 NCOLS=5
^^WI {
%     CLEAR
%     INSERT "^^WI @ 2,2 STATIC T0 'Restrain "
%     GET SILENT TEXT 'Atom 1'
%     EVALUATE CAT1 = CVALUE
%     INSERT "to"
%     GET SILENT TEXT 'Atom 2'
%     EVALUATE CAT2 = CVALUE
%     INSERT "'"
%     GET SILENT NOSTORE TEXT 'type end...'
%     OUTPUT
%     CLEAR
^^WI   @ 4,2 GRID LEFT NROWS=3 NCOLS=5
^^WI   {
^^WI     @ 1,1 STATIC T1 'Distance'
^^WI     @ 1,3 EDITBOX E1 '1.47' CHARS=6 REAL
^^WI     @ 1,5 STATIC T2 'angstroms'
^^WI     @ 3,1 STATIC T3 'E.s.d.'
^^WI     @ 3,3 EDITBOX E2 '0.05' CHARS=6 REAL
^^WI     @ 3,5 STATIC T4 'angstroms'
^^WI   }
^^WI   @ 4,4 GRID RIGHT NROWS=3 NCOLS=1
^^WI   {
^^WI     @ 1,1 BUTTON BOK '&Ok' COMMIT DEFAULT
^^WI     @ 3,1 BUTTON BXX '&Cancel' CANCEL
^^WI   }
^^WI }
^^WI  SHOW
^^CR  
%     VERIFY BOK BXX
%     GET SILENT NOSTORE FINAL ABBREVIATED 'Ok or cancel?'
%     CASE VALUE
%       BLOCK %BOK%
^^??      E1 TEXT
%         GET SILENT NOSTORE REAL 'Distance' '1.0'
%         EVALUATE RSVAL = CVALUE
^^??      E2 TEXT
%         GET SILENT NOSTORE REAL 'Esd' '0.02'
%         EVALUATE RSESD = CVALUE
%         EVALUATE CLINE1 = 'DISTANCE ' // RSVAL // ' , ' // RSESD -
 // ' = ' // CAT1 // ' to ' // CAT2
%         COPY '#SCRIPT YADDLI16'
^^WI      DISPOSE XRESTRD
^^CR
%       END BLOCK
%       BLOCK %BXX%
^^WI      DISPOSE XRESTRD
^^CR
%         FINISH
%       END BLOCK
%     END CASE
%   END BLOCK
%   BLOCK %ANGLES%
%% Get three values and an END.
^^WI WINDOW XRESTRD 'Restrain Angle' MODAL
^^WI GRID RESMAIN NROWS=5 NCOLS=5
^^WI {
%     CLEAR
%     INSERT "^^WI @ 2,2 STATIC T0 'Restrain "
%     GET NOSTORE SILENT TEXT 'Middle atom'
%     EVALUATE CATM = CVALUE
%     GET NOSTORE SILENT TEXT 'Atom 1'
%     EVALUATE CAT1 = CVALUE
%     GET SILENT NOSTORE TEXT 'Atom 2'
%     EVALUATE CAT2 = CVALUE
%     GET SILENT NOSTORE TEXT 'Atom 3'
%     EVALUATE CAT3 = CVALUE
%     IF ( CAT1 .EQ. CATM ) THEN
%       EVALUATE CAT1 = CAT2
%     ELSE IF ( CAT3 .EQ. CATM ) THEN
%       EVALUATE CAT3 = CAT2
%     END IF
%     EVALUATE CAT2 = CATM
%     TRANSFER CAT1 // "-" // CAT2 // "-" // CAT3 // "'" TO BUFFER
%     GET SILENT NOSTORE TEXT 'type end...'
%     OUTPUT
%     CLEAR
^^WI   @ 4,2 GRID LEFT NROWS=3 NCOLS=5
^^WI   {
^^WI     @ 1,1 STATIC T1 'Angle'
^^WI     @ 1,3 EDITBOX E1 '108.5' CHARS=6 REAL
^^WI     @ 1,5 STATIC T2 'degrees'
^^WI     @ 3,1 STATIC T3 'E.s.d.'
^^WI     @ 3,3 EDITBOX E2 '1.7' CHARS=6 REAL
^^WI     @ 3,5 STATIC T4 'degrees'
^^WI   }
^^WI   @ 4,4 GRID RIGHT NROWS=3 NCOLS=1
^^WI   {
^^WI     @ 1,1 BUTTON BOK '&Ok' COMMIT DEFAULT
^^WI     @ 3,1 BUTTON BXX '&Cancel' CANCEL
^^WI   }
^^WI }
^^WI  SHOW
^^CR  
%     VERIFY BOK BXX
%     GET SILENT NOSTORE FINAL ABBREVIATED 'Ok or cancel?'
%     CASE VALUE
%       BLOCK %BOK%
^^??      E1 TEXT
%         GET SILENT NOSTORE REAL 'Angle' '108.5'
%         EVALUATE RSVAL = CVALUE
^^??      E2 TEXT
%         GET SILENT NOSTORE REAL 'Esd' '1.8'
%         EVALUATE RSESD = CVALUE
%         EVALUATE CLINE1 = 'DISTANCE ' // RSVAL // ' , ' // RSESD -
 // ' = ' // CAT1 // ' to ' // CAT2 // ' to ' // CAT3
%         COPY '#SCRIPT YADDLI16'
^^WI      DISPOSE XRESTRD
^^CR
%       END BLOCK
%       BLOCK %BXX%
^^WI      DISPOSE XRESTRD
^^CR
%         FINISH
%       END BLOCK
%     END CASE
%   END BLOCK
%   BLOCK %PLANE%
Planar restraint access not implemented yet. Use EDLIST16.
%   END BLOCK
% END CASE
%END SCRIPT
