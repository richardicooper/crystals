#!/bin/sh

if [ -z $CRYSSRC ]; then
  echo CRYSSRC not set.
  builderr CRYSSRC_NOT_SET
  exit
fi

if [ -n $1 ]; then
  export COMPCODE=$1;
  echo COMPCODE set to $COMPCODE;
elif [ -z $COMPCODE ]; then
  echo COMPCODE not set.
  builderr COMPCODE_not_given_Usage_autobuild_COMPCODE
  exit
fi

source $CRYSSRC/bin/autovars

cd $CRYSSRC || builderr CRYSSRC_NOT_FOUND
rm -Rf $CRYSBUILD > prev || builderr CRYSBUILD_not_REMOVED rm prev
cvs -d $CVSROOT update -dP > cvsup 2>&1 || builderr CVS_UPDATE cvs cvsup
mkdir $CRYSBUILD || builderr CRYSBUILD_NOT_MADE mkdir
cd $CRYSBUILD
code
cd $CRYSBUILD
buildscript
cd $CRYSBUILD
buildlocal
cd $CRYSBUILD
dsc
cd $CRYSBUILD
precomp
cd $CRYSBUILD
buildman


