C $Log: not supported by cvs2svn $
C
CODE FOR DISTAN
      SUBROUTINE DISTAN
      CALL XSYSDC(-1,1)
      CALL XDISTC
      RETURN
      END
C
CODE FOR XDISTC
      SUBROUTINE XDISTC
C--MAIN DISTANCE ANGLES CONTROL ROUTINE.
\XUNITS
&PPC\XGSTOP
C
C--
C
C--LOAD THE NEXT '#INSTRUCTION'
1000  CONTINUE
      NUM=KNXTOP(LSTOP,LSTNO,ICLASS)
C--CHECK IF WE SHOULD RETURN
      IF(NUM)1100,1100,1200
1100  CONTINUE
      RETURN
C--BRANCH ON THE TYPE OF OPERATION
1200  CONTINUE
      GOTO (2100, 2200, 8100, 8000, 2200, 2300, 2400,
     1 2500, 2600, 1300),NUM
C1300  STOP 56
1300   CALL GUEXIT(53)
C
C--DISTANCE ANGLES CALCULATION
2100  CONTINUE
      CALL XDIST
      GOTO 1000
C
C--- #PEAKS OR \REGROUP
2200  CONTINUE
      CALL XCOND
      GOTO 1000
C--'#COLLECT'
2300  CONTINUE
      CALL XCOLL
      GOTO 1000
C----- #LABEL
2400  CONTINUE
C ----- LABEL REMOVED FEB 97
      GOTO 1000
C----- #OCCMOD
2500  CONTINUE
C----- OCCMOD REMOVED FEB 97
      GOTO 1000
C----- #AUTOMATIC
2600  CONTINUE
c      CALL AUTOMA
C----- AUTOMA REMOVED FEB 97
      GOTO 1000
C
C
C--'#END' INSTRUCTION
8000  CONTINUE
      CALL XMONTR(-1)
      CALL XEND
&PPCCS***
&PPC      IF ( GLSTOP .EQ. 1 ) THEN
&PPC          GOTO 1100
&PPC      ELSE
&PPCCE***
      GOTO 1000
&PPCCS***
&PPC      ENDIF
&PPCCE***
C
C--'#TITLE' INSTRUCTION
8100  CONTINUE
      CALL XRCN
      GOTO 1000
      END
C
