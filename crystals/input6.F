CODE FOR INPUT6
      SUBROUTINE INPUT6
      CALL XSYSDC(-1,1)
      CALL XRDL67
      RETURN
      END
C 
CODE FOR XRDL67
      SUBROUTINE XRDL67
C--MAIN ROUTINE TO CONTROL THE INPUT OF LIST 6 AND LIST 7
C
C--
\ISTORE
C
\STORE
\XUNITS
\XCHARS
\XLST50
\XERVAL
\XSSVAL
\XIOBUF
&PPC\XGSTOP
C
\QSTORE
C
C--LOAD THE NEXT '#INSTRUCTION'
1000  CONTINUE
      NUM=KNXTOP(LSTOP,LSTNO,ICLASS)
C--CHECK IF WE SHOULD RETURN
      IF(NUM)1100,1100,1200
1100  CONTINUE
      RETURN
C--BRANCH ON THE TYPE OF OPERATION
1200  CONTINUE
      IF(LSTOP)1400,1400,1900
C--THIS IS NOT A LIST INPUT OPERATION  -  BRANCH ON THE FUNCTION
1400  CONTINUE
      LSTNO=6
      GOTO (2100,2200,2600,2700,1500),NUM
C1500  STOP 325
1500  CALL GUEXIT(325)
C--THIS IS A LIST TYPE OPERATION  -  BRANCH ON ITS FUNCTION
1900  CONTINUE
      GOTO (2100,6000,7000,1300),LSTOP
C1300  STOP 150
C
1300  CALL GUEXIT(150)
C--READ THE LIST FROM THE INPUT MEDIUM
2100  CONTINUE
      CALL XRD06(LSTNO)
      GOTO 1000
C
C--'#ABS' INSTRUCTION
2200  CONTINUE
      CALL XABS
      GOTO 1000
C
C--'#TITLE' INSTRUCTION
2600  CONTINUE
      CALL XRCN
      GOTO 1000
C
C--'#END' INSTRUCTION
2700  CONTINUE
      CALL XMONTR(-1)
      CALL XEND
&PPCCS***
&PPC      IF ( GLSTOP .EQ. 1 ) THEN
&PPC          GOTO 1100
&PPC      ELSE
&PPCCE***
      GOTO 1000
&PPCCS***
&PPC      ENDIF
&PPCCE***
C
C--PRINT THE LIST
6000  CONTINUE
      ITEMP1=NR60
      ITEMP2=NR61
      NR60=0
      NR61=0
      I=KRDDPV(ISTORE(NFL),4)
      NR60=ITEMP1
      NR61=ITEMP2
      CALL XRSL
      CALL XCSAE
      IF(ICLASS)6410,6420,6020
C--PRINT ON THE SCALE OF /FO/
6410  CONTINUE
      CALL XPRT6C(-1)
      GOTO 1000
C--PRINT ON THE SCALE OF /FC/
6420  CONTINUE
      CALL XPRT6C(+1)
      GOTO 1000
C--NORMAL LIST PRINT
6020  CONTINUE
      CALL XPRTLN(LSTNO)
      GOTO 1000
C
C--LIST PUNCH ROUTINE
7000  CONTINUE
      ITEMP1=NR60
      ITEMP2=NR61
      NR60=0
      NR61=0
      I=KRDDPV(ISTORE(NFL),4)
      NR60=ITEMP1
      NR61=ITEMP2
      CALL XRSL
      CALL XCSAE
C--CHECK THAT THIS IS LIST 6
      IF(LSTNO-6)7100,7300,7100
C--NOT LIST 6  -  AN ERROR
7100  CONTINUE
      CALL XERHDR(0)
      IF (ISSPRT .EQ. 0) WRITE(NCWU,7200)LSTNO,IH
      WRITE ( NCAWU , 7200 ) LSTNO , IH
      WRITE ( CMON, 7200) LSTNO, IH
      CALL XPRVDU(NCVDU, 1,0)
7200  FORMAT(' Illegal list number for ''',A1,'punch''')
      CALL XERHND ( IERERR )
      GO TO 1000
C--CHECK THE TYPE OF PUNCH
7300  CONTINUE
      GOTO (7310, 7340, 7320, 7330 ) ICLASS+2
      GOTO 1000
C--NORMAL PUNCH FORMAT
7310  CONTINUE
      CALL XPCH6G(ICLASS)
      GOTO 1000
C--NORMAL DATA, ONE REFLECTION PRE CARD
7320  CONTINUE
      CALL XPCH6S
      GOTO 1000
C--OBSERVED QUANTITIES ONLY
7330  CONTINUE
      CALL XPCH6O
      GOTO 1000
C----- CIF OUTPUT
7340  CONTINUE
      CALL XPCH6C
      GOTO 1000
      END
C
